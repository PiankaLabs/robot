(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{21:function(e,n,t){},22:function(e,n,t){},47:function(e,n,t){"use strict";t.r(n);var o=t(0),i=t(2),r=t.n(i),a=t(13),c=t.n(a),s=(t(21),t(22),t(14)),l=t(4),u=t.n(l),d=t(15),m=[],f=0,g=4096;function v(e){(function(){console.log("Creating stream...");var e={audio:!0};return navigator.mediaDevices.getUserMedia(e)})().then((function(e){return console.log("Creating stream source..."),(new AudioContext).createMediaStreamSource(e)})).then((function(e){console.log("Creating script processor...");var n=1,t=e.context.createScriptProcessor(g,n,n);return e.connect(t),t.connect(e.context.destination),t})).then(function(e){return function(n){console.log("Creating audio event processor..."),n.onaudioprocess=function(t){console.log("Processing audio event...");var o=0,i=new Float32Array(g);if(t.inputBuffer.copyFromChannel(i,o),function(e){m.push(e),f+=e.length}(i),f>1e4){console.log("Merging, sampling, and encoding buffer..."),console.log("Sample rate: "+n.context.sampleRate);var r=function(e,n,t){var o=16e3,i=function(e){for(var n=new ArrayBuffer(2*e.length),t=new DataView(n),o=0;o<e.length;o++){var i=Math.max(-1,Math.min(1,e[o]));t.setInt16(2*o,i<0?32768*i:32767*i,!0)}return t}(function(e,n,t){if(t===n)return e;var o=n/t,i=Math.round(e.length/o),r=new Float32Array(i),a=0,c=0;for(;a<r.length;){for(var s=Math.round((a+1)*o),l=0,u=0,d=c;d<s&&d<e.length;d++)l+=e[d],u++;r[a]=l/u,a++,c=s}return r}(function(e,n){var t=new Float32Array(n),o=0;return e.forEach((function(e){t.set(e,o),o+=e.length})),t}(e,n),t,o));return new Blob([i])}(m,f,n.context.sampleRate);console.log("Clearing..."),m=[],f=0,console.log("Calling back..."),e(r)}}}}(e))}function b(){!function(){var e=new d.w3cwebsocket("wss://piankabot.lan:8443/microphone");e.onclose=function(e){console.log(e)},e.onerror=function(e){console.error(e)},e.onopen=function(){return v((function(n){return n.arrayBuffer().then((function(n){return e.send(n)}))}))}}();var e=document.getElementById("video"),n=document.getElementById("audio"),t=document.getElementById("microphoneWaveform"),o=document.getElementById("audioWaveform");e.src="/video",n.src="/audio",n.play(),t.src="/microphone/waveform",t.style.visibility="visible",o.src="/audio/waveform",o.style.visibility="visible";for(var i=document.getElementsByClassName("WaveformLabel"),r=0;r<i.length;r++)i.item(r).style.visibility="visible";for(var a=document.getElementsByClassName("Joystick"),c=0;c<a.length;c++)a.item(c).style.visibility="visible";return n.currentTime+=5,document.getElementById("start").hidden=!0,n.hidden=!0,!1}function h(e){u.a.get("/robot/".concat(e.x,"/").concat(e.y))}function j(e){u.a.get("/robot/0/0")}var p=function(){return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)("div",{id:"start",className:"Start",children:Object(o.jsx)("a",{onClick:b,href:"#",children:"\u25b6"})}),Object(o.jsxs)("div",{className:"App-header",children:[Object(o.jsx)("img",{id:"video",className:"Video"}),Object(o.jsx)("audio",{id:"audio",className:"Audio"})]}),Object(o.jsx)("div",{className:"Joystick",children:Object(o.jsx)(s.Joystick,{size:100,move:h,stop:j})}),Object(o.jsxs)("div",{className:"MicrophoneWaveform",children:[Object(o.jsxs)("span",{className:"WaveformLabel",children:[Object(o.jsx)("span",{className:"iconify","data-icon":"mdi:web","data-inline":"false"})," 48,000.0 Hz, 16 Bit, mono, 2 bytes/frame"]}),Object(o.jsx)("br",{}),Object(o.jsx)("img",{id:"microphoneWaveform"})]}),Object(o.jsxs)("div",{className:"AudioWaveform",children:[Object(o.jsxs)("span",{className:"WaveformLabel",children:[Object(o.jsx)("span",{className:"iconify","data-icon":"mdi-robot","data-inline":"false"})," 16,000.0 Hz, 16 Bit, stereo, 2 bytes/frame"]}),Object(o.jsx)("br",{}),Object(o.jsx)("img",{id:"audioWaveform"})]})]})},y=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,48)).then((function(n){var t=n.getCLS,o=n.getFID,i=n.getFCP,r=n.getLCP,a=n.getTTFB;t(e),o(e),i(e),r(e),a(e)}))};c.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(p,{})}),document.getElementById("root")),y()}},[[47,1,2]]]);
//# sourceMappingURL=main.2a49265d.chunk.js.map